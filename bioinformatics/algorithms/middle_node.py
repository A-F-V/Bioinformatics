indel = -5

blosum62 = {
    ('W', 'F'): 1, ('L', 'R'): -2, ('S', 'P'): -1, ('V', 'T'): 0,
    ('Q', 'Q'): 5, ('N', 'A'): -2, ('Z', 'Y'): -2, ('W', 'R'): -3,
    ('Q', 'A'): -1, ('S', 'D'): 0, ('H', 'H'): 8, ('S', 'H'): -1,
    ('H', 'D'): -1, ('L', 'N'): -3, ('W', 'A'): -3, ('Y', 'M'): -1,
    ('G', 'R'): -2, ('Y', 'I'): -1, ('Y', 'E'): -2, ('B', 'Y'): -3,
    ('Y', 'A'): -2, ('V', 'D'): -3, ('B', 'S'): 0, ('Y', 'Y'): 7,
    ('G', 'N'): 0, ('E', 'C'): -4, ('Y', 'Q'): -1, ('Z', 'Z'): 4,
    ('V', 'A'): 0, ('C', 'C'): 9, ('M', 'R'): -1, ('V', 'E'): -2,
    ('T', 'N'): 0, ('P', 'P'): 7, ('V', 'I'): 3, ('V', 'S'): -2,
    ('Z', 'P'): -1, ('V', 'M'): 1, ('T', 'F'): -2, ('V', 'Q'): -2,
    ('K', 'K'): 5, ('P', 'D'): -1, ('I', 'H'): -3, ('I', 'D'): -3,
    ('T', 'R'): -1, ('P', 'L'): -3, ('K', 'G'): -2, ('M', 'N'): -2,
    ('P', 'H'): -2, ('F', 'Q'): -3, ('Z', 'G'): -2, ('X', 'L'): -1,
    ('T', 'M'): -1, ('Z', 'C'): -3, ('X', 'H'): -1, ('D', 'R'): -2,
    ('B', 'W'): -4, ('X', 'D'): -1, ('Z', 'K'): 1, ('F', 'A'): -2,
    ('Z', 'W'): -3, ('F', 'E'): -3, ('D', 'N'): 1, ('B', 'K'): 0,
    ('X', 'X'): -1, ('F', 'I'): 0, ('B', 'G'): -1, ('X', 'T'): 0,
    ('F', 'M'): 0, ('B', 'C'): -3, ('Z', 'I'): -3, ('Z', 'V'): -2,
    ('S', 'S'): 4, ('L', 'Q'): -2, ('W', 'E'): -3, ('Q', 'R'): 1,
    ('N', 'N'): 6, ('W', 'M'): -1, ('Q', 'C'): -3, ('W', 'I'): -3,
    ('S', 'C'): -1, ('L', 'A'): -1, ('S', 'G'): 0, ('L', 'E'): -3,
    ('W', 'Q'): -2, ('H', 'G'): -2, ('S', 'K'): 0, ('Q', 'N'): 0,
    ('N', 'R'): 0, ('H', 'C'): -3, ('Y', 'N'): -2, ('G', 'Q'): -2,
    ('Y', 'F'): 3, ('C', 'A'): 0, ('V', 'L'): 1, ('G', 'E'): -2,
    ('G', 'A'): 0, ('K', 'R'): 2, ('E', 'D'): 2, ('Y', 'R'): -2,
    ('M', 'Q'): 0, ('T', 'I'): -1, ('C', 'D'): -3, ('V', 'F'): -1,
    ('T', 'A'): 0, ('T', 'P'): -1, ('B', 'P'): -2, ('T', 'E'): -1,
    ('V', 'N'): -3, ('P', 'G'): -2, ('M', 'A'): -1, ('K', 'H'): -1,
    ('V', 'R'): -3, ('P', 'C'): -3, ('M', 'E'): -2, ('K', 'L'): -2,
    ('V', 'V'): 4, ('M', 'I'): 1, ('T', 'Q'): -1, ('I', 'G'): -4,
    ('P', 'K'): -1, ('M', 'M'): 5, ('K', 'D'): -1, ('I', 'C'): -1,
    ('Z', 'D'): 1, ('F', 'R'): -3, ('X', 'K'): -1, ('Q', 'D'): 0,
    ('X', 'G'): -1, ('Z', 'L'): -3, ('X', 'C'): -2, ('Z', 'H'): 0,
    ('B', 'L'): -4, ('B', 'H'): 0, ('F', 'F'): 6, ('X', 'W'): -2,
    ('B', 'D'): 4, ('D', 'A'): -2, ('S', 'L'): -2, ('X', 'S'): 0,
    ('F', 'N'): -3, ('S', 'R'): -1, ('W', 'D'): -4, ('V', 'Y'): -1,
    ('W', 'L'): -2, ('H', 'R'): 0, ('W', 'H'): -2, ('H', 'N'): 1,
    ('W', 'T'): -2, ('T', 'T'): 5, ('S', 'F'): -2, ('W', 'P'): -4,
    ('L', 'D'): -4, ('B', 'I'): -3, ('L', 'H'): -3, ('S', 'N'): 1,
    ('B', 'T'): -1, ('L', 'L'): 4, ('Y', 'K'): -2, ('E', 'Q'): 2,
    ('Y', 'G'): -3, ('Z', 'S'): 0, ('Y', 'C'): -2, ('G', 'D'): -1,
    ('B', 'V'): -3, ('E', 'A'): -1, ('Y', 'W'): 2, ('E', 'E'): 5,
    ('Y', 'S'): -2, ('C', 'N'): -3, ('V', 'C'): -1, ('T', 'H'): -2,
    ('P', 'R'): -2, ('V', 'G'): -3, ('T', 'L'): -1, ('V', 'K'): -2,
    ('K', 'Q'): 1, ('R', 'A'): -1, ('I', 'R'): -3, ('T', 'D'): -1,
    ('P', 'F'): -4, ('I', 'N'): -3, ('K', 'I'): -3, ('M', 'D'): -3,
    ('V', 'W'): -3, ('W', 'W'): 11, ('M', 'H'): -2, ('P', 'N'): -2,
    ('K', 'A'): -1, ('M', 'L'): 2, ('K', 'E'): 1, ('Z', 'E'): 4,
    ('X', 'N'): -1, ('Z', 'A'): -1, ('Z', 'M'): -1, ('X', 'F'): -1,
    ('K', 'C'): -3, ('B', 'Q'): 0, ('X', 'B'): -1, ('B', 'M'): -3,
    ('F', 'C'): -2, ('Z', 'Q'): 3, ('X', 'Z'): -1, ('F', 'G'): -3,
    ('B', 'E'): 1, ('X', 'V'): -1, ('F', 'K'): -3, ('B', 'A'): -2,
    ('X', 'R'): -1, ('D', 'D'): 6, ('W', 'G'): -2, ('Z', 'F'): -3,
    ('S', 'Q'): 0, ('W', 'C'): -2, ('W', 'K'): -3, ('H', 'Q'): 0,
    ('L', 'C'): -1, ('W', 'N'): -4, ('S', 'A'): 1, ('L', 'G'): -4,
    ('W', 'S'): -3, ('S', 'E'): 0, ('H', 'E'): 0, ('S', 'I'): -2,
    ('H', 'A'): -2, ('S', 'M'): -1, ('Y', 'L'): -1, ('Y', 'H'): 2,
    ('Y', 'D'): -3, ('E', 'R'): 0, ('X', 'P'): -2, ('G', 'G'): 6,
    ('G', 'C'): -3, ('E', 'N'): 0, ('Y', 'T'): -2, ('Y', 'P'): -3,
    ('T', 'K'): -1, ('A', 'A'): 4, ('P', 'Q'): -1, ('T', 'C'): -1,
    ('V', 'H'): -3, ('T', 'G'): -2, ('I', 'Q'): -3, ('Z', 'T'): -1,
    ('C', 'R'): -3, ('V', 'P'): -2, ('P', 'E'): -1, ('M', 'C'): -1,
    ('K', 'N'): 0, ('I', 'I'): 4, ('P', 'A'): -1, ('M', 'G'): -3,
    ('T', 'S'): 1, ('I', 'E'): -3, ('P', 'M'): -2, ('M', 'K'): -1,
    ('I', 'A'): -1, ('P', 'I'): -3, ('R', 'R'): 5, ('X', 'M'): -1,
    ('L', 'I'): 2, ('X', 'I'): -1, ('Z', 'B'): 1, ('X', 'E'): -1,
    ('Z', 'N'): 0, ('X', 'A'): 0, ('B', 'R'): -1, ('B', 'N'): 3,
    ('F', 'D'): -3, ('X', 'Y'): -1, ('Z', 'R'): 0, ('F', 'H'): -1,
    ('B', 'F'): -3, ('F', 'L'): 0, ('X', 'Q'): -1, ('B', 'B'): 4
}

PAM250 = {
'A': { 'A':2, 'R':-2, 'N':0, 'D':0, 'C':-2, 'Q':0, 'E':0, 'G': 1, 'H': -1, 'I':-1, 'L':-2, 'K':-1, 'M':-1, 'F':-3, 'P':1, 'S':1, 'T': 1, 'W':-6, 'Y':-3, 'V':0, 'B':2, 'Z':1},
'R': { 'A':-2, 'R':6, 'N':0, 'D':-1, 'C':-4, 'Q':1,'E': -1,'G': -3, 'H': 2, 'I':-2,'L': -3, 'K':3, 'M':0, 'F':-4, 'P':0, 'S':0, 'T':-1, 'W':2, 'Y':-4, 'V':-2, 'B':1, 'Z':2},
'N': {'A':0, 'R':0, 'N':2, 'D':2, 'C':-4, 'Q': 1,'E': 1, 'G':0, 'H':2, 'I':-2, 'L':-3, 'K':1, 'M':-2, 'F':-3, 'P':0,'S': 1, 'T':0, 'W':-4,'Y': -2,'V': -2,'B': 4,'Z': 3},
'D': {'A':0, 'R':-1, 'N':2, 'D':4, 'C':-5, 'Q': 2,'E': 3,'G': 1, 'H': 1, 'I':-2, 'L':-4, 'K':0,'M': -3, 'F':-6, 'P':-1, 'S':0, 'T':0,'W': -7,'Y': -4, 'V':-2, 'B':15, 'Z':4},
'C': {'A':-2, 'R':-4, 'N':-4, 'D':-5, 'C':12, 'Q':-5,'E': -5,'G': -3, 'H': -3,'I': -2,'L': -6,'K': -5,'M': -5,'F': -4,'P': -3,'S': 0,'T': -2,'W': -8,'Y': 0,'V': -2,'B': -3,'Z': -4},
'Q': {'A':0, 'R':1, 'N':1, 'D':2, 'C':-5, 'Q': 4, 'E':2,'G': -1, 'H': 3, 'I':-2, 'L':-2,'K': 1, 'M':-1, 'F':-5,'P': 0,'S': -1,'T': -1, 'W':-5, 'Y':-4,'V': -2,'B': 3,'Z': 5},
'E': {'A':0, 'R':-1, 'N':1, 'D':3, 'C':-5, 'Q':2,'E': 4,'G': 0, 'H':1, 'I':-2, 'L':-3, 'K':0,'M': -2, 'F':-5,'P': -1, 'S':0,'T': 0, 'W':-7, 'Y':-4, 'V':-2, 'B':4,'Z': 5},
'G': {'A':1, 'R':-3, 'N':0, 'D':1, 'C':-3, 'Q': -1, 'E':0,'G': 5, 'H': -2, 'I':-3, 'L':-4,'K': -2, 'M':-3, 'F':-5, 'P':0, 'S':1,'T': 0,'W': -7, 'Y':-5, 'V':-1, 'B':2,'Z': 1},
'H': {'A':-1, 'R':2, 'N':2, 'D':1, 'C':-3, 'Q':3,'E': 1,'G': -2, 'H':6, 'I':-2, 'L':-2, 'K':0,'M': -2,'F': -2, 'P':0, 'S':-1,'T': -1,'W': -3, 'Y':0, 'V':-2, 'B':3, 'Z':3},
'I' :{'A':-1, 'R':-2, 'N':-2, 'D':-2, 'C':-2, 'Q':-2,'E': -2,'G': -3, 'H': -2,'I': 5,'L': 2,'K': -2,'M': 2,'F': 1, 'P':-2, 'S':-1,'T': 0, 'W':-5,'Y': -1,'V': 4,'B': -1, 'Z':-1},
'L': {'A':-2, 'R':-3, 'N':-3, 'D':-4, 'C':-6, 'Q':-2, 'E':-3, 'G':-4, 'H': -2, 'I':2, 'L':6, 'K':-3,'M': 4,'F': 2, 'P':-3, 'S':-3,'T': -2,'W': -2, 'Y':-1, 'V':2, 'B':-2, 'Z':-1},
'K': {'A':-1, 'R':3, 'N':1, 'D':0, 'C':-5, 'Q':1, 'E':0, 'G':-2, 'H':0, 'I':-2, 'L':-3,'K': 5,'M': 0, 'F':-5, 'P':-1, 'S':0, 'T':0, 'W':-3, 'Y':-4, 'V':-2, 'B':2, 'Z':2},
'M': {'A':-1, 'R':0, 'N':-2, 'D':-3, 'C':-5, 'Q':-1, 'E':-2,'G': -3, 'H': -2,'I': 2,'L': 4,'K': 0, 'M':6, 'F':0, 'P':-2, 'S':-2, 'T':-1, 'W':-4, 'Y':-2,'V': 2, 'B':-1, 'Z':0},
'F': {'A':-3, 'R':-4, 'N':-3, 'D':-6,'C': -4, 'Q':-5, 'E':-5, 'G':-5, 'H':-2, 'I':1,'L': 2,'K': -5,'M': 0,'F': 9,'P': -5,'S': -3,'T': -3,'W': 0,'Y': 7,'V': -1,'B': -3,'Z': -4},
'P': {'A':1, 'R':0, 'N':0, 'D':-1, 'C':-3, 'Q': 0, 'E':-1, 'G':0, 'H':0,'I': -2,'L': -3,'K': -1,'M': -2,'F': -5,'P': 6, 'S':1, 'T':0, 'W':-6,'Y': -5, 'V':-1,'B': 1, 'Z':1},
'S': {'A':1, 'R':0, 'N':1, 'D':0,'C': 0, 'Q':-1, 'E':0, 'G':1, 'H': -1,'I': -1, 'L':-3, 'K':0, 'M':-2,'F': -3, 'P':1, 'S':2, 'T':1, 'W':-2,'Y': -3,'V': -1, 'B':2, 'Z':1},
'T': {'A':1, 'R':-1, 'N':0, 'D':0,'C': -2, 'Q':-1, 'E':0, 'G':0, 'H':-1,'I': 0,'L': -2,'K': 0, 'M':-1,'F': -3, 'P':0, 'S':1, 'T':3,'W': -5,'Y': -3,'V': 0, 'B':2, 'Z':1},
'W': {'A':-6, 'R':2, 'N':-4, 'D':-7,'C': -8, 'Q':-5, 'E':-7, 'G':-7, 'H':-3,'I': -5,'L': -2,'K': -3,'M': -4,'F': 0, 'P':-6,'S': -2,'T': -5, 'W':17,'Y': 0,'V': -6,'B': -4,'Z': -4},
'Y': {'A':-3, 'R':-4, 'N':-2, 'D':-4,'C': 0, 'Q':-4, 'E':-4, 'G':-5, 'H':0, 'I':-1,'L': -1, 'K':-4, 'M':-2,'F': 7, 'P':-5, 'S':-3, 'T':-3,'W': 0,'Y': 10,'V': -2,'B': -2, 'Z':-3},
'V': {'A':0, 'R':-2, 'N':-2, 'D':-2, 'C':-2, 'Q': -2,'E': -2,'G': -1, 'H': -2, 'I':4,'L': 2, 'K':-2,'M': 2,'F': -1, 'P':-1, 'S':-1, 'T':0, 'W':-6,'Y': -2, 'V':4,'B': 0, 'Z':0},
'B': {'A':2, 'R':1, 'N':4, 'D':5, 'C':-3, 'Q':3, 'E':4, 'G':2, 'H': 3, 'I':-1, 'L':-2,'K': 2, 'M':-1,'F': -3,'P': 1, 'S':2, 'T':2,'W': -4,'Y': -2,'V': 0,'B':6, 'Z':5},
'Z': {'A':1, 'R':2, 'N':3, 'D':4, 'C':-4, 'Q':5, 'E':5, 'G':1, 'H':3, 'I':-1, 'L':-1, 'K':2, 'M':0, 'F':-4,'P': 1, 'S':1, 'T':1,'W': -4, 'Y':-3, 'V':0, 'B':5, 'Z':6}}

def blosum62score(a,b):
    return blosum62[(a,b)] if (a,b) in blosum62 else blosum62[(b,a)]

def prefix(s1,s2,col):
    height = len(s1)
    c1 = [i*indel for i in range(0,height+1)]
    for _ in range(1,col+1):
        c2 = [c1[0]+indel]
        c2.extend(
            max(
                c2[row - 1] + indel,
                c1[row] + indel,
                c1[row - 1] + blosum62score(s1[row - 1], s2[col - 1]),
            )
            for row in range(1, height + 1)
        )
        c1 = c2
    return c1

def suffix(s1,s2,col):
    width = len(s2)
    return prefix(s1[-1::-1],s2[-1::-1],width-col)

def listsum(l1,l2):
    return [l1[x]+l2[x] for x in range(len(l1))]

def middleNode(s1,s2):
    width = len(s2)
    mid =  (width-1)//2
    score = listsum(prefix(s1,s2,mid),suffix(s1,s2,mid))
    print(score)
    bestrow = 0
    bestscore = score[0]
    for row in range(1,len(s1)+1):
        if score[row]>bestscore:
            bestscore = score[row]
            bestrow= row
    return (bestrow,mid),bestscore

def middleEdge(s1,s2):
    node,bestscore = middleNode(s1,s2)
    nex = (node[0],node[1]+1)
    nexscore = bestscore+indel
    if bestscore+blosum62score(s1[node[0]+1],s2[node[1]+1])>nexscore:
        nex= (node[0]+1,node[1]+1)
    return (node),(nex) 



s1 = "PLEASANTLY"
s2 = "MEASNLY"

print(middleNode(s1,s2))

def rosalind(filei,filej,func):
    with open(filei,"r") as f:
        w1 = f.readline().rstrip('\n')
        w2 = f.readline().rstrip('\n')
    o  = func(w1,w2)
    with open(filej,"w") as f:
        f.writelines(str(o))

rosalind("i1.txt","o1.txt",middleEdge)